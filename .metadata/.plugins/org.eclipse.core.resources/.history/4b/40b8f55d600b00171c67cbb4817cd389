package by.htp.library;

import java.util.Arrays;

public class Deletemax {
	public static void main (String[] args){
		//создаем матрицу используя двумерный массив
		int x = 5; /*(int)(Math.random()*5+1);*/
		int y = 5; /*(int)(Math.random()*5+1);*/
		int [][] arr = new int [x][y];
		//заполняем массив
		for (int i = 0; i < x; i++) {
	            for (int j = 0; j < y; j++) {
			arr[i][j] = (int)(Math.random()*10);
	            }
	        }
	    //выводим исходный массив
		for (int i = 0; i < x; i++) {
	            for (int j = 0; j < y; j++) {
	                System.out.print(arr[i][j]+"");
	            }
	            System.out.println();
	        }
		
		int max = -1;
		//ищем максимальные элементы
		for (int i = 0; i < x; i++) {
	            for (int j = 0; j < y; j++) {
			if (max<arr[i][j]){
			max = arr[i][j];
	                }
	            }
	            
	        }
		System.out.println("Max:"+max);
		//ищем колчиество максимальных элементов
		int quant = 0;
		for (int i = 0; i < x; i++) {
	            for (int j = 0; j < y; j++) {
	            	if (max==arr[i][j]){
	            		quant = quant+1;
	                }
	            }
	            
	    }
	    System.out.println("quantity of max elements:"+quant);
	    if (x == 1&&y == 1) {
	     	System.out.println("There was only one array cell, so it has just disappeared.");
			System.exit(0);
	    }

	    //создаем массив, содержащий номера позиций максимальных элементов
	    int [] arr2 = new int [quant*2];
	    int q = 0; //variable used for filling in coordinates of max elements
		for (int i = 0; i < x; i++) {
	        for (int j = 0; j < y; j++) {
	        	if (max==arr[i][j]){
	        		arr2[q] = i;
	        		arr2[q+1] = j;
	        		q = q+2;
	            }
	        }
	            
	    }
		 //print array with positions coordinates
		for (int i=0;i<arr2.length;i++) {
			System.out.print(arr2[i]);
		}
		System.out.println("");
		int [] arrx = new int[arr2.length/2];
		int [] arry = new int[arr2.length/2];
		
		int tempCount = 0;
		for	(int i = 0;i <arr2.length;i+=2){
			arrx[tempCount] = arr2[i];
			tempCount++;
		}
		tempCount = 0;
		for	(int i = 1;i <arr2.length;i+=2){
			arry[tempCount] = arr2[i];
			tempCount++;
		}
		 //print array with positions coordinates
		for (int i=0;i<arrx.length;i++) {
			System.out.print(arrx[i]);
		}
		System.out.println("");
		Arrays.sort(arry);
		 //print array with positions coordinates
		for (int i=0;i<arry.length;i++) {
			System.out.print(arry[i]);
		}
		Arrays.sort(arrx);
		
		
		 int dc = 1;//number of columns to be deleted
		 int dr = 1;//number of rows to be deleted
	  
	     System.out.println("");
	     if (quant>1){
	     
	     dc = 1; 
	     for (int i = 0;i<arry.length-1;i++){
	     	if (arry[i]!=arry[i+1]){
	     		dc = dc+1;
	     	}
	     }
	     if (dc==y){
	     	System.out.println("All the columns have disappeared.");
	     	System.exit(0);
	     }
		
		dr = 1; 
	     for (int i = 0;i<arrx.length-1;i++){     	
	     	if (arrx[i]!=arrx[i+1]){
	     		dr = dr+1;
	     	}
	     }
	     if (dr==x){
	     	System.out.println("All the rows have disappeared.");
	     	System.exit(0);
	     }
		}
	
		System.out.println("dc:"+dc);
		System.out.println("dr:"+dr);
		//creating final array
		int finx = x-dr; //number of rows in final array
		int finy = y-dc; //number of columns in final array
		int [][] finarr = new int [finx][finy];
		
		boolean yesx = false; //Для проверки на наличие координаты по позиции х, если есть, то пропускаем строку исходного массива
		boolean yesy = false; //Для проверки на наличие координаты по позиции у, если есть, то пропускаем столбец исходного массива
		int e = 0; //
		int r = 0; //
		for (int i = 0;i<x;i++){
			r=0;
			yesx = false;
			for (int q1 = 0;q1<arrx.length;q1++){
				if (i == arr2[q1]){
					yesx = true;
				}
			}
			if (yesx){
				continue;
			}
			for (int j = 0;j<y;j++) {
				yesy = false;
				for (int q2 = 0;q2<arry.length;q2++){
					if	(j== arr2[q2]){
						yesy = true;
					}
				}
				if (yesy){
					continue;
				}
				finarr [e][r] = arr[i][j];
				r++;
			}
			e++;
		}
		//выводим финальный массив
		for (int i = 0; i < finx; i++) {
	            for (int j = 0; j < finy; j++) {
	                System.out.print(finarr[i][j]);
	            }
	            System.out.println();
	        }


	}

}
